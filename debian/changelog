thumbnailer (2.3+16.04.20160204.1-0ubuntu1) xenial; urgency=medium

  [ Michi Henning ]
  * Fixed incorrect build dependency for settings-defaults.h.
  * Re-enabled tests on powerpc and s390x, except for qml test.
  * Disabled vs-thumb test on powerpc64le due to gstreamer codec bug.
  * 100% coverage again for thumbnailextractor.cpp.
  * 100% coverage on thumbnailer. A few coding style fixes. Improved
    error handling and diagnostics via unity::Exception. Fixed incorrect
    logic in vs-thumb when launching the child process and collecting
    error/timeout info.
  * 1920 size limit for images in full-size cache. Thumbnails are also
    limited to 1920, unless the caller asks for (0,0), in which case we
    return the original size. Images in the full-size cache are now
    always stored a jpeg instead of original format. Fixed minor bug in
    dbus test.
  * A few minor fixes flagged by coverity.
  * A number of files had the wrong license header (LGPL instead of
    GPL). Also fixed style of license headers so they are consistent
    throughout.
  * Added DBus interface for stats collection.
  * Added HACKING file.
  * Added better coverage target. Currently, the code still uses a
    private XEnableCoverage module. Once the MR for cmake-extras merges,
    we'll use the version in there. See
    https://code.launchpad.net/~michihenning/cmake-extras/cmake-extras-
    coverage/+merge/258021.
  * Added clear and clear-stats commands to thumbnailer admin. (LP:
    #1462204)
  * Added coverage exclusions to credentials cache. It doesn't look
    possible to cover the remaining code paths with reasonable effort.
  * Added devscripts to build dependencies.
  * Added lsb-release to build deps.
  * Added message handler for QDebug so we get time stamps and locking,
    so trace doesn't interleave across threads. Other changes are coding
    style issues, and slightly improved diagnostics in some cases. Also
    removed a bunch of redunant #includes and re-ordered include
    directives.
  * Added missing compact and shutdown commands to thumbnailer-admin.
  * Added namespaces to all code that was still in the global namespace.
  * Added recovery logic such that, if any operation on a persistent
    cache reports db corruption, we wipe the cache and retry the
    operation.
  * Added start-stop messages to thumbnailer service. That's useful when
    changing settings, which are read only on start-up, and to monitor
    initialization time.
  * Added suppressions for a large number of warnings caused by Qt5 when
    compiling with clang. Removed left-behind unused directory. In turn,
    that triggered some other failures (stand-alone header tests were
    failing). Also fixed up doc generation to actually use the doxygen
    file we provided. (The one in /usr/share/cmake doesn't allow us to
    turn off graph generation.).
  * Added tests for stand-alone header compilation, copyright, and
    whitespace. Fixed errors reported by those.
  * Added thumbnailer-admin tool. Removed obsolete tools. Improved
    coverage.
  * Added timeout to ThumbnailRequest::download(), so we can control
    timeout value for the tests.
  * Added two missing codec guards to test.
  * Added vs-thumb to coverage targets.
  * Added work-around for QNetworkAcessManager problems when device is
    in flight mode. (LP: #1470284)
  * After long discussions with slangasek, robru, and infinity, ignored
    test failures for s390x because, by an unfortunate chain of events,
    s390x packages were published back on 2 November.
  * Avoid calling download() after we get a hit on the failure cache.
    This was needlessly slowing down retrieval of thumbnails when we
    definitely do not have any artwork. Improved diagnostics when
    something goes wrong with subprocess termination. Restored single-
    shot timer for handler and downloader. Removed incorrect Q_EMIT in
    timeout().
  * Avoid the intermediate conversion to tiff for audio and video files
    with embedded artwork.
  * Bring coverage for Image class back up to 100%.
  * Cache no longer implicitly compacts the DB on shutdown. Instead, it
    now provides an explicit compact() method. The DBus service now
    shuts down the thumbnailer before tearing down the DBus connection,
    so it is guaranteed that the DB locks are released before DBus can
    start another service instance.
  * Changed audio cover art extraction to use taglib.
  * Changed code to cache full-size images only if the are remote or, if
    they are local, if they are inside and audio or video container.
    Otherwise, we use the local image file directly and don't cache it.
  * Changed default backlog to 10. Change RateLimiter to work on LIFO
    basis. Fixes lp:1531038. (LP: #1531038)
  * Changed steady_clock to system_clock because steady_clock resets at
    reboot, so it's no good for persistent time stamps.
  * Changed the default number of concurrent downloads to 8.
  * Clearing all caches now also resets the network retry timeout.
  * Code examples from doc are now compiled and tested. Doc includes the
    real source code as snippets, so the example code in the doc is
    guaranteed correct. Re-worked the example to discourage use of a
    separate Thumbnailer instance (and separate DBus connection) for
    each request.
  * Dealt with remaining coverage issues by adding tests or suppressing
    as needed. Made file_lock test skip slow parts when slowtests is
    off.
  * Did a copy edit of the documentation. Fixed minor issues with
    lintian and changed doc generation to use the cmake-extras module.
  * Disabled stand-alone header compilation tests when slowtests option
    is set.
  * Do not treat request timeout as a temporary error because we see
    this quite often from the remote server. (LP: #1528105)
  * Documented location of on-disk cache files.
  * Emit warning for invalid QSize passed by QML, in preparation for
    turning this into an error. (Lazy applications end up hammering the
    cache with full-size thumbnails when passing an invalid QSize.).
  * Factored out dbus name and dbus paths into separate header so they
    aren't hard-wired repeatedly all over the place. Also made a bunch
    of style fixes and removed a bunch of redundant header files.
  * Fix broken assertions in thumbnailer.cpp.
  * Fix noise about policy 28 from cmake when building on Vivid.
  * Fixed a few broken diagnostic pragmas. Replaced remaining double-
    include guards with #pragma once.
  * Fixed broken key construction in thumbnailer.cpp.
  * Fixed broken local install target.
  * Fixed build error with clang.
  * Fixed cancellation logic if requests are destroyed without being
    cancelled first. Documentation and test improvements.
  * Fixed clang warnings about missing pragma push.
  * Fixed compile error caused by new version of
    /usr/include/sys/apparmor.h.
  * Fixed inability to change size of pre-existing cache via dconf. Made
    max thumbnail size configurable, as well as retry interval after
    authoritative and non-authoritative download failure. More detailed
    semantic checking and error reporting for config parameters.
  * Fixed incorrect hit rate reported on service start-up. (LP:
    #1506304)
  * Fixed incorrect scaling of thumbnails with dimensions (w,0) or
    (0,h). (LP: #1515848)
  * Fixed lots of valgrind issues, so "make valgrind" is usable again.
  * Fixed minor bug in fake server for artist thread test. Added test
    case for lastfmdownloader getting artist art.
  * Fixed poor cancellation logic.
  * Fixed problem found with valgrind: after detecting a version
    mismatch, we had a path through the code that used an uninitialized
    value.
  * Fixed stale comment for make_output_path().
  * Fixed time conversion code to generate fixed point independent of
    locale. Fixed stats test to test for correct time regardless of
    locale. Added sanity test for non-epoch timestamps to verify that
    marshaling and conversion work correctly; the test now checks that
    the timestamps are near the current time. Fixed type spec in the xml
    to match reality.
  * Fixed typo in error message.
  * Fixed ubuntuserverdownloader to behave correctly when test machine
    has no internet connection.
  * Fixes for the transition to gcc 5. A few tests no longer compiled
    with boost 1.58. The changes work with both gcc-4.9/boost-1.55 and
    gcc-5.0/boost-58. (LP: #1476738)
  * Fixes two minor bugs in the vs-thumb test.
  * Follow Pete's advice and use explicit link directive for Qt5
    libraries to get rid of "policy 28" warnings from cmake when
    building in release mode.
  * Got rid of QDateTime in CacheStats.
  * I've added the leveldb cache to the tree. It's not used by anything,
    just hooked up to the build env so it compiles and passes its tests.
    Eventually, this will move into a separate core project but, for the
    time being, we'll dog-food it here to see how we go with the API.
  * If max-extractions == 0: if hardware == BQ, adjust to 1 else if
    hardware == Arm, adjust to 2 else leave at 0 If max-extractions !=
    0, use it as set.
  * Improved coverage testing for vs-thumb.
  * Improved coverage, mainly for qml.
  * Improved test coverage.
  * Improvements to build env:
  * Increased signal wait time for CI Train. Minor renaming for
    consistency and excluding tests from coverage.
  * Limit max-extractions to 2 on Arm.
  * Made download/extract timeout configurable.
  * Made license headers consistent.
  * Made statistics persist across re-starts. Added dirty flag so we can
    tell if we didn't shut down cleanly. If so, the stats counters
    automatically reset to zero. For clean caches, we now avoid the scan
    over the Atime index on start-up.
  * Made write_file() atomic using rename(). Added some tests for
    file_io functions.
  * Michi Henning 2016-01-04 Added exponential backoff for unexpected
    server errors.
  * Minor change to get command syntax to make it consistent (underscore
    vs hyphen). Also renamed clear-stats to zero-stats.
  * Minor coverage improvement for vs-thumb, plus better error message.
  * Minor doc fix.
  * Minor fixes to man pages.
  * Minor fixes to speed test: adjusted some types to prevent overflow
    when benchmarking very large caches and fixed two insignificant off-
    by-one errors. Changed prerequisite branch; now calling compact()
    explicitly in speed test.
  * Minor optimizations to reduce memory pressure.
  * Minor style fix.
  * More detailed trace. It now splits out time spent waiting in queue
    and actual extraction time, so we can see whether a request was slow
    because it was delayed in the queue, or because the extraction
    itself was slow.
  * More valgrind suppressions for errors we can't do anything about.
    (LP: #1476506)
  * More valgrind suppressions for stuff we started calling recently.
  * Moved Thumbnailer into the internal namespace. Un-pimpled
    Thumbnailer and VideoScreenshotter. Image class coverage back up to
    100%. Slightly better coverage for Thumbnailer. Fixed Thumbnailer
    test to not create a new temp dir for each test. (Because of the
    caching in glib, the tempdir "stuck" at the first one that was
    created.).
  * Moved rate limiter from QML to Qt side. Fixed bug in libthumbnailer-
    qt that caused the state of completed request to not be released.
    Changed stress test to test the rate limiting via Qt.
  * Partially refactored vs-thumb. Better performance, tracing, and
    error messages.
  * Picked some more low-hanging coverage fruit (mostly suppressions).
    Improved diagnostics in a few places and fixed a few incorrect error
    message.
  * Put the code through formatcode.
  * Reduced the internal block cache size for small caches. This reduces
    cache memory requirements for the thumbnailer service from 24 MB to
    13.5 MB without affecting performance. Renamed a variable in the
    speed test for clarity.
  * Relaxed a few valgrind suppression for gcc5 ABI. Added new
    suppressions for Wily. Fixed incorrect test names in
    CtestCustom.cmake.in. (LP: #1476506)
  * Removed 100% quality setting when saving jpg. Using default 75% now,
    which is a lot smaller. Full-size cache contains high-quality
    images, so we don't accumulate scaling artefacts. Adjusted tests
    accordingly.
  * Removed LastFM downloader, seeing that we are not using it.
  * Removed check for impossible error condition.
  * Removed hack to try and deal with the arm gstreamer problems in a
    hardware-specific way.
  * Removed headroom concept because it doesn't achieve anything other
    than making the benchmark look better. Shortened speed test so it
    runs faster with mechanical disks.
  * Removed stale assert that that got left behind after resolving a
    merge conflict.
  * Removed unused code I left behind by mistake when resolving a merge
    conflict. Fixed incorrect warning suppression for gtest.
  * Renamed VideoScreenshotter to ImageExtractor because that more
    accurately expresses what it does. (It's used for audio and video
    files.) Improved diagnostics. Did minor style tidy-up and removed
    unused code. Destructor now-waits for sub-process to complete.
  * Replaced returning of thumbnails via file descriptor with returning
    the image contents directly over DBus. About 7-8% performance
    improvement for hits on 128-size thumbnails.
  * Restructured tests so each test has its own directory. Test targets
    are now pushed into the top-level CMakeLists.txt so the test targets
    for coverage are updated automatically. Removed no-longer needed
    tools.
  * Save vs-thumb output as TIFF instead of PNG. That's about 20%
    faster.
  * Set default extraction concurrency to number of cores.
  * Stopped bogus cancellation messages when client-trace is turned on.
  * Suppress a bunch of warnings from cmake when building in release
    mode.
  * Suppressed build warning from gstcompat.h.
  * Suppressed build warning when compiling with clang.
  * This adds a failure cache to the mix, so we don't endlessly re-try
    failed downloads or aborted attempts to extract a thumbnail from a
    broken local media file. Cache size and timeouts for failure entries
    are hard-coded for the time being, until we get around to making
    this configurable.
  * This replaces the media art cache with the new cache. Note that, for
    now, the images are returned without scaling in original size.
  * Two trivial new valgrind suppressions. (LP: #1476506)
  * Updated doc for Thumbnailer constructors.
  * Use EnableCoverageReport from cmake-extras. Fixed warning in clang
    build.
  * Use an advisory lock to prevent shutdown/start-up race between
    service instances. Disconnect from DBus at the earliest possible
    moment so new requests will be redirected to a new instance. (LP:
    #1511553)
  * Use new cache for local thumbnails. This is poor in regression
    tests, but has reasonably good coverage. For now, I've tested
    thumbnail extraction manually by saving retrieved thumbnails and
    inspecting them by hand. Will add more tests that are more rigorous
    next.
  * Using old signal syntax in test because, on arm64 on Vivid, the test
    fails with the new syntax.
  * Various doc improvements. Tweaks to speed test to make it more
    realistic.
  * Various improvements for clang: support for address/thread sanitizer
    allow coverage testing with clang fixed a bunch of clang warnings .
  * We no longer add an entry to the failure cache if thumbnailing fails
    because the network is down. Renamed network_error() to
    network_down() to make it clear that this is an expected failure
    (rather than a surprising one). Changed enumerators for FetchStatus
    to lower case as per style guide. Refactored fetch() for artist and
    album into common helper function.
  * invalidate() now implicitly clears the ephemeral stats too. It
    doesn't make sense to keep them around after wiping the cache.
  * make_directories() now uses g_mkdir_with_parents().
  * vs-thumb now looks for both image and preview image tags to extract
    artwork.
  * vs-thumb now saves as png, to avoid artefacts due to applying jpg
    compression three times. Previously, we saved as jpg 75% in vs-
    thumb, then again at 90% for the full-size cache, and then a third
    time at 75% when creating the actual thumbnail. Now it's lossless ->
    90% -> 75%, which should be OK (90% is nearly perfect).

  [ Albert Astals Cid ]
  * Fixes suggested by clazy
  * Only create the QQuickTextureFactory when needed (LP: #1484914)

  [ James Henstridge ]
  * Add a GetThumbnail D-Bus method to thumbnailer-service for local
    thumbnails, and update the QML plugin to use it rather than
    libthumbnailer directly.
  * Add a test fixture that runs QML tests against a private version of
    thumbnailer-service.
  * Add a test suite to check the behaviour of the D-Bus service.
    Currently only covers GetThumbnail, with GetAlbumArt/GetArtistArt to
    come later when we can substitute in the fake implementation of the
    art service.
  * Add a test that handles the case when we can't connect to the online
    art service, and actually log errors from the art downloader.
  * Add settings support for the cache size.
  * Add some direct C++ tests for the QQuickImageProvider
    implementations in the QML plugin.
  * Add some sample files in MP3 and M4A format with cover art.
  * Allow constructing an Image from a file descriptor as an alternative
    to in-memory data.
  * Change ImageExtractor to take a file name rather than file
    descriptor, and pass that to vs-thumb rather than using an fd://$N
    URI.
  * Clean up ImageResponse implementation in QML plugin.
  * Compile using -fvisibility=hidden to reduce code size.
  * Convert the ThumbnailExtractor class to run the extraction within
    the event loop. (LP: #1425009)
  * Convert the VideoScreenshotter class to an asynchronous API so we
    can wait on the vs-thumb helper process from the event loop rather
    than by blocking in the thread pool.
  * Convert the test_dbus test to use generated stubs, and inspect
    returned images using the Image class.
  * Create a small utility library for common test setup code.
  * Don't install libthumbnailer.so, instead statically linking the code
    into thumbnailer-service.  As a consequence, the libthumbnailer0 and
    libthumbnailer-dev binary packages have been removed.
  * Factor out common DBus test setup code, and add some more targets to
    the coverage report.
  * Fix up the permission bit constants used in the aa_query_label
    permission check.
  * If applications do not specify a size for their thumbnails, return a
    128x128 thumbnail.  This is what the old thumbnailer did by
    accident.
  * If multiple requests for the same resource are received, delay
    processing of the second request (and subsequent ones) so we can
    take advantage of any downloads (for album requests), extracted
    images (for videos/songs), or cached failures.
  * If the subprocess is still running in the ImageExtractor destructor,
    try to kill it again, and log if waitForFinished() fails.
  * In the QML plugin, use the shared connection to the session bus and
    use a single RateLimiter instance.
  * Invoke gcovr directly rather than using a cmake command file.
    Update the filter pattern glob->regexp conversion for the gcovr
    command line arguments to match what lcov does.
  * Limit the concurrency of downloads and vs-thumb invocations.
  * Merge the Handler subclasses into their base in the D-Bus service.
  * Move the AppArmor check earlier so it is not skipped for files
    already in the cache. (LP: #1381713)
  * Move thumbnailing code to a set of Request classes in preparation
    for exposing asynchronous downloading for use by the D-Bus service.
  * Pass the requested size to the D-Bus service directly rather than
    converting it to a ThumbnailSize constant first.
  * Port the QML plugin to use libthumbnailer-qt instead of using direct
    D-Bus calls.  As a result, qtdeclarative5-ubuntu-thumbnailer0.1 now
    depends on libthumbnailer-qt1.0.
  * Port thumbnailer-service to QDBus.
  * Remove dependency on libsoup and libxml2, since the corresponding
    code is now gone.
  * Remove the filename_fd argument to the GetThumbnail() D-Bus method,
    instead using aa_query_label() to check whether the caller has
    access to the relevant file. (LP: #1381713)
  * Rename unique_gobj<T> to gobj_ptr<T>.
  * Revert back to the version of vs-thumb in the previous version of
    thumbnailer released to the archive.
  * Scale images while loading them, and use the EXIF thumbnail if it is
    at least as large as the requested size.
  * Set finish_time within the Handler::sendThumbnail and sendError
    methods so it is guaranteed to be set before the finished signal is
    emitted. (LP: #1467751)
  * Split out the D-Bus method request handlers into separate classes,
    with some processing happening in a thread pool (where blocking is
    permissible) and some in the event loop thread (where blocking is
    not allowed, but we don't monopolise a thread).
  * Track the credentials (user ID, AppArmor label) of clients
    connecting to the D-Bus service.  This is not yet used to make
    security decisions.
  * Update the Thumbnailer class API to return ThumbnailRequest objects,
    and make the art D-Bus handlers perform downloads asynchronously in
    the event loop.
  * Use playbin to extract audio and video thumbnails, rather than a
    custom pipeline.
  * Use the file descriptor we open at the start of the request when
    thumbnailing videos or songs.
  * When reading a potentially animated image, stop processing chunks
    once we've fully decoded the first frame.  This reduces the IO and
    CPU load when thumbnailing large animated GIF files. (LP: #1527315)
  * When thumbnailing local photos make sure we are reading from the
    file that matches the client's file descriptor.  Videos/songs still
    end up re-opening the file at present.

  [ Michael Sheldon ]
  * Fall back to full content type detector if the fast detector fails
    to return anything useful (e.g. because a file doesn't have an
    extension). (LP: #1499341)

  [ Xavi Garcia ]
  * Added 2 QThreadPools to run separately the check and create phases.
  * Added Async Image Provider.
  * Added a new inactivity handler to exist the thumbnailer service
    after some time of inactivity.
  * Added new method to check if the download finished due to a network
    error.
  * Added setting values for max-downloads and max-video-thumbnails, so
    we can tune concurrency without re-building.
  * Added tool to parse the Settings schema and create a header file
    with the default values.
  * Adds the thumbnailer API library code and unit tests.
  * Changed ArtDownloader interface to return std::string containing the
    image.
  * Fake server modified to add returning 404 code when the file we try
    to read is not found, also erased some imports and methods that were
    not used.
  * I've added tests for album and artist download using the fake server
    and the downloaders.
  * Modified strerror to use safe_strerror instead.
  * Moved public headers of libthumbnailer in the source tree to match
    the namespace and installation path.
  * Removed the size parameter from the artist and album queries.
  * This branch is not expected to be merged as includes changes not
    fully working.
  * This branch moves a class that will be used in the new library API
    for the thumbnailer to a common directory and renames the target
    name of the static library previously called thumbnailer to
    thumbnailer-static.
  * Thumbnailer API library documentation.

  [ Xavi Garcia Mena ]
  * Added a new inactivity handler to exist the thumbnailer service
    after some time of inactivity.
  * Added unit tests for dbus using fake server. Also includes
    modification in fake server to return binary data.
  * Adds the thumbnailer API library code and unit tests.
  * Fake server modified to add returning 404 code when the file we try
    to read is not found, also erased some imports and methods that were
    not used.
  * Fixed data being truncated. Added workaround to avoid adding the
    "album" prefix to the album name.
  * This branch is not expected to be merged as includes changes not
    fully working.
  * This branch moves a class that will be used in the new library API
    for the thumbnailer to a common directory and renames the target
    name of the static library previously called thumbnailer to
    thumbnailer-static.
  * Thumbnailer API library documentation.

 -- Michi Henning <michi.henning@canonical.com>  Thu, 04 Feb 2016 05:47:34 +0000

thumbnailer (2.3+16.04.20160108.2-0ubuntu1) xenial; urgency=medium

  [ Michi Henning ]
  * Fixed incorrect display of cache policy by "thumbnailer-admin stats".
  * Limit GIF file size to 2 MB (LP: #1527315).
  * Fix non-working config settings for client-side API (LP: #1528058).

  [ CI Train Bot ]
  * No-change rebuild.

 -- Michi Henning <michi.henning@canonical.com>  Fri, 08 Jan 2016 12:43:17 +0000

thumbnailer (2.3+16.04.20160107.1-0ubuntu1) xenial; urgency=medium

  * Fix for lp:1531038. Much better user experience this way. (LP:
    #1531038)

 -- Michi Henning <michi.henning@canonical.com>  Thu, 07 Jan 2016 06:33:30 +0000

thumbnailer (2.3+16.04.20160107-0ubuntu1) xenial; urgency=medium

  [ Michi Henning ]
  * Ignored failing tests on PPC due to gstreamer problems.
  * Fixed crash that happened if the service was shut down
    while there were requests still processing in the
    thread pools.
  * Fixed incorrect handling of 400 (Bad Request) response from
    remote server (LP: #1512608).
  * Passing an invalid size to the QML or Qt APIs is now an error.
  * Added new gsettings key "log-level". Amount of noise in the logs
    is now reduced. Set log-level to 2 for verbose logging.

  [ CI Train Bot ]
  * No-change rebuild.

 -- Michi Henning <michi.henning@canonical.com>  Thu, 07 Jan 2016 04:36:39 +0000

thumbnailer (2.3+16.04.20151102.2-0ubuntu1) xenial; urgency=medium

  [ Michi Henning ]
  * "thumbnailer-admin clear f" now also resets the network retry timeout.
  * API documentation and man page improvements.
  * Videos with embedded artwork now display the artwork thumbnail instead
    of an extracted still frame (LP: #1510801).
  * Added cancelled() accessor to Request class.
  * Requests made via the Qt and QML APIs are correctly rate-limited now.
  * Added trace-client key to gsettings.
  * Service log now shows statistics on start-up.
  * Resetting the stats now also resets the network failure retry timout.
  * Fix for cover art extraction if only a preview cover image is available.

  [ Michael Sheldon ]
  * Added more robust content type detection (LP: #1499341).

  [ CI Train Bot ]
  * debian/libthumbnailer-qt1.0.symbols: update to released version.
  * No-change rebuild.

 -- Michi Henning <michi.henning@canonical.com>  Mon, 02 Nov 2015 12:36:56 +0000

thumbnailer (2.3+15.10.20150915.1-0ubuntu1) wily; urgency=medium

  [ Michi Henning ]
  * Added man pages for thumbnailer-admin, thumbnailer-service,
    and thumbnailer-settings.
  * Removed a bunch of lintian warnings and errors.
  * Removed source for persistent cache.
  * Added inactivity timeout to admin interface, so the service
    exits after 30 seconds if it is started only to, for example,
    retrieve the stats. Activity on the admin interface now keeps
    the service alive the same way activity on the thumbnailer interface does.
  * Added average hit and miss run length to stats returned by
    thumbnailer-admin.
  * Changed semantics for requests with (0,0) size. All requests are now
    clamped to a 1920x1920 bounding box.
  * Fixed incorrect timeout semantics for unexpected network errors.

  [ James Henstridge ]
  * Renamed QML package to qml-module-XXX format and add transitional
    package. (LP: #1342031)
  * Port QML module to use libthumbnailer-qt.

  [ Xavi Garcia ]
  * Add new libthumbnailer-qt1.0 library, providing a C++ client API.

  [ Albert Astals Cid ]
  * In QML image provider, only create QQuickTextureFactory when
    needed, fixing a memory leak when requests are cancelled. (LP:
    #1484914)

  [ CI Train Bot ]
  * debian/libthumbnailer-qt1.0.symbols: update to released version.
  * New rebuild forced.

 -- Michi Henning <michi.henning@canonical.com>  Tue, 15 Sep 2015 11:04:14 +0000

thumbnailer (2.2+15.10.20150801-0ubuntu1) wily; urgency=medium

  [ Michi Henning ]
  * Compatibility fixes  for GCC 5, Boost 1.58, and Libapparmor 2.10.
  * Correctly initialise the cache stats after upgrading from an old
    cache version.
  * Rename clear-stats sub-command of thumbnailer-admin to zero-stats.

  [ James Henstridge ]
  * Pass a filename to the vs-thumb helper utility rather than a file
    descriptor.  This avoids the use of the fdsrc GStreamer element, which
    appears to be unstable on Wily.

  [ CI Train Bot ]
  * New rebuild forced.

 -- CI Train Bot <ci-train-bot@canonical.com>  Sat, 01 Aug 2015 04:32:14 +0000

thumbnailer (2.1.1) UNRELEASED; urgency=medium

  [ Michi Henning ]
  * Added request limiter on the qml side, so we don't overrun DBus with
    too many outstanding requests. (DBus kills the connection if there
    are more than 400 or so outstanding requests.)

 -- Michi Henning <michi.henning@canonical.com>  Mon, 03 Aug 2015 14:28:09 +1000

thumbnailer (2.1+15.10.20150715-0ubuntu1) wily; urgency=medium

  [ James Henstridge ]
  * Expose more settings for the thumbnailer daemon via GSettings.
  * Change the security policy implementation to use aa_query_label()
    for file access checks rather than relying on file descriptor
    passing.  This avoids the file descriptor exhaustion bugs with the
    previous implementation. (LP: #1381713)

  [ Michi Henning ]
  * Add thumbnailer-admin tool, which can be used to check the status
    of the cache and generate thumbnails via the command line.
  * Add time stamps to log messages.
  * Reduce the memory footprint of small caches, which in turn reduces
    the footprint of thumbnailer-service.
  * Don't implicitly compact the cache on service shutdown, as this
    can take some time.
  * Persist the cache stats over restarts of thumbnailer-service.
  * Don't save JPEG thumbnails at quality=100, since the quality
    improvement isn't justified by the extra storage.
  * Don't retry downloads when we have a hit from the failure cache.
  * Warn if an app requests an unsized thumbnail.

  [ CI Train Bot ]
  * New rebuild forced.

 -- CI Train Bot <ci-train-bot@canonical.com>  Wed, 15 Jul 2015 02:03:28 +0000

thumbnailer (2.0+15.10.20150527-0ubuntu2) wily; urgency=medium

  * Switch to unversioned Conflicts/Replaces on libthumbnailer0 to force
    removal of the obsolete package on upgrade from the previous version.

 -- Adam Conrad <adconrad@ubuntu.com>  Wed, 17 Jun 2015 05:15:54 -0600

thumbnailer (2.0+15.10.20150527-0ubuntu1) wily; urgency=medium

  [ James Henstridge ]
  * New upstream version with many changes:
    - Switch to new cache implementation based on leveldb.
    - Move local file thumbnailing to the central D-Bus daemon,
      allowing for the cache to be shared between apps and its size
      kept under control.
    - The libthumbnailer library has been removed, since all clients
      of the cache rely on the D-Bus interface now.
    - The QML plugin now uses the QQuickAsyncImageProvider interface,
      enabling multiple thumbnails to be loaded simultaneously.
    - Improved test coverage.
  * Remove the libthumbnailer0 and libthumbnailer-dev binary packages.

 -- CI Train Bot <ci-train-bot@canonical.com>  Wed, 27 May 2015 05:36:31 +0000

thumbnailer (1.3+15.04.20150312-0ubuntu1) vivid; urgency=medium

  [ Albert Astals Cid ]
  * Use own QDBusConnection (LP: #1410260)

 -- CI Train Bot <ci-train-bot@canonical.com>  Thu, 12 Mar 2015 08:38:44 +0000

thumbnailer (1.3+15.04.20150122-0ubuntu1) vivid; urgency=low

  [ Florian Boucault ]
  * Keeps track of failed thumbnails and do not try to regenerate them.
    (LP: #1389678)
  * QML thumbnail provider: make sure sourceSize (aka requestedSize) is
    respected by downscaling at loading time if necessary. Makes
    TN_SIZE_ORIGINAL case much faster. (LP: #1391368)

 -- Ubuntu daily release <ps-jenkins@lists.canonical.com>  Thu, 22 Jan 2015 08:56:16 +0000

thumbnailer (1.3+15.04.20150106-0ubuntu1) vivid; urgency=low

  [ Jussi Pakkanen ]
  * Fix a few potential memory corruptions. (LP: #1403906)

 -- Ubuntu daily release <ps-jenkins@lists.canonical.com>  Tue, 06 Jan 2015 18:50:46 +0000

thumbnailer (1.3+15.04.20141202-0ubuntu1) vivid; urgency=low

  [ Alfonso Sanchez-Beato ]
  * [ Alfonso Sanchez-Beato ] Workaround for files with very few intra
    frames (LP: #1393834)

 -- Ubuntu daily release <ps-jenkins@lists.canonical.com>  Tue, 02 Dec 2014 14:10:09 +0000

thumbnailer (1.3+15.04.20141106-0ubuntu1) vivid; urgency=low

  [ Jussi Pakkanen ]
  * Fix memory leak.
  * Use videoflip to fix orientation. (LP: #1191934)

 -- Ubuntu daily release <ps-jenkins@lists.canonical.com>  Thu, 06 Nov 2014 05:38:14 +0000

thumbnailer (1.3+15.04.20141105-0ubuntu1) vivid; urgency=low

  [ Ricardo Salveti de Araujo ]
  * Enabling exif thumbnails again, as we now got the proper fix at
    qtubuntu-camera

 -- Ubuntu daily release <ps-jenkins@lists.canonical.com>  Wed, 05 Nov 2014 04:05:25 +0000

thumbnailer (1.3+14.10.20141002-0ubuntu1) utopic; urgency=low

  [ Jussi Pakkanen ]
  * Disable exif thumbnails temporarily to work around a regression.

 -- Ubuntu daily release <ps-jenkins@lists.canonical.com>  Thu, 02 Oct 2014 19:20:24 +0000

thumbnailer (1.3+14.10.20140926-0ubuntu1) utopic; urgency=medium

  [ Pawel Stolowski ]
  * Added gsettings schema with API key used for accessing dash.ubuntu.com service.
    - Pass the key with artist/album requests.
  * Install album_missing icon (taken from libunitycore package).

  [ Jussi Pakkanen ]
  * Use exif thumbnail if one is available.
  * A few simple fixes for issues found compiling against libc++.
  * Prevent apport from sending vs-thumb stacktraces.

  [ Pete Woods ]
  * There is a new thumbnailer-common package to hold default icons.

 -- Ubuntu daily release <ps-jenkins@lists.canonical.com>  Fri, 26 Sep 2014 11:25:18 +0000

thumbnailer (1.2+14.10.20140916-0ubuntu1) utopic; urgency=low

  [ Jussi Pakkanen ]
  * Make a few classes more resistant to copying.
  * Clean up warnings as reported by gcc and shiny new clang.

 -- Ubuntu daily release <ps-jenkins@lists.canonical.com>  Tue, 16 Sep 2014 08:14:04 +0000

thumbnailer (1.2+14.10.20140904-0ubuntu1) utopic; urgency=low

  [ Ubuntu daily release ]
  * New rebuild forced

  [ Jussi Pakkanen ]
  * Move embedded thumbnail extraction to a helper binary to avoid
    linking main library with gstreamer. (LP: #1363314)

 -- Ubuntu daily release <ps-jenkins@lists.canonical.com>  Thu, 04 Sep 2014 07:43:24 +0000

thumbnailer (1.2+14.10.20140901.is.1.2+14.10.20140814-0ubuntu2) utopic; urgency=medium

  * Reintroduce the pthread linkage fix from 1.2+14.10.20140827.1-0ubuntu1,
    required for the package to build.

 -- Steve Langasek <steve.langasek@ubuntu.com>  Tue, 02 Sep 2014 13:26:28 -0700

thumbnailer (1.2+14.10.20140901.is.1.2+14.10.20140814-0ubuntu1) utopic; urgency=medium

  * Revert the last two landings. The 1.2+14.10.20140827.1 version
    introduced a serious regression breaking many projects, indirectly
    caused by thumbnailer using gst.  LP: #1363314.

 -- Łukasz 'sil2100' Zemczak <lukasz.zemczak@canonical.com>  Tue, 02 Sep 2014 21:50:08 +0200

thumbnailer (1.2+14.10.20140901-0ubuntu1) utopic; urgency=medium

  [ Pawel Stolowski ]
  * Changed requested images sizes to better match sizes supported by the web server.

 -- Ubuntu daily release <ps-jenkins@lists.canonical.com>  Mon, 01 Sep 2014 07:32:23 +0000

thumbnailer (1.2+14.10.20140827.1-0ubuntu1) utopic; urgency=low

  [ Jussi Pakkanen ]
  * Re-enable embedded album art.
  * Link against thread library explicitly.

 -- Ubuntu daily release <ps-jenkins@lists.canonical.com>  Wed, 27 Aug 2014 15:55:17 +0000

thumbnailer (1.2+14.10.20140814-0ubuntu1) utopic; urgency=low

  [ Jussi Pakkanen ]
  * Print log message when errors happen.

 -- Ubuntu daily release <ps-jenkins@lists.canonical.com>  Thu, 14 Aug 2014 13:41:35 +0000

thumbnailer (1.2+14.10.20140812-0ubuntu1) utopic; urgency=medium

  [ Pawel Stolowski ]
  * Use Ubuntu webservice for album art and provide artist art API.

 -- Ubuntu daily release <ps-jenkins@lists.canonical.com>  Tue, 12 Aug 2014 16:57:24 +0000

thumbnailer (1.1+14.10.20140811-0ubuntu1) utopic; urgency=low

  [ Ubuntu daily release ]
  * debian/libthumbnailer0.symbols: auto-update to released version

  [ Arthur Mello ]
  * Work with file names with non-european characters by not writing
    metadata chunks when they can't be represented in ISO-8859-1. (LP:
    #1319698)

  [ Jussi Pakkanen ]
  * Work with file names with non-european characters by not writing
    metadata chunks when they can't be represented in ISO-8859-1. (LP:
    #1319698)

  [ Pawel Stolowski ]
  * Request images of size 400 instead of 200 from ubuntu server.

 -- Ubuntu daily release <ps-jenkins@lists.canonical.com>  Mon, 11 Aug 2014 14:20:34 +0000

thumbnailer (1.1+14.04.20140401.1-0ubuntu3) utopic; urgency=medium

  * No-change rebuild to get dbgsyms for all binaries onto
    ddebs.ubuntu.com

 -- Steve Langasek <steve.langasek@ubuntu.com>  Thu, 24 Jul 2014 14:14:15 -0700

thumbnailer (1.1+14.04.20140401.1-0ubuntu2) utopic; urgency=medium

  * No-change rebuild for shlib changes in qtbase and qtdeclarative.

 -- Ricardo Salveti de Araujo <ricardo.salveti@canonical.com>  Tue, 29 Apr 2014 14:53:03 -0700

thumbnailer (1.1+14.04.20140401.1-0ubuntu1) trusty; urgency=low

  [ Michal Hruby ]
  * Provide virtual thumbnailer package.

 -- Ubuntu daily release <ps-jenkins@lists.canonical.com>  Tue, 01 Apr 2014 22:45:34 +0000

thumbnailer (1.1+14.04.20140331-0ubuntu1) trusty; urgency=medium

  [ Jussi Pakkanen ]
  * New minor release.

 -- Ubuntu daily release <ps-jenkins@lists.canonical.com>  Mon, 31 Mar 2014 09:08:36 +0000

thumbnailer (1.0+14.04.20140327-0ubuntu1) trusty; urgency=low

  [ Jussi Pakkanen ]
  * Obey the TMPDIR. (LP: #1296987)

 -- Ubuntu daily release <ps-jenkins@lists.canonical.com>  Thu, 27 Mar 2014 08:36:59 +0000

thumbnailer (1.0+14.04.20140319-0ubuntu1) trusty; urgency=low

  [ Jussi Pakkanen ]
  * Prevent crash if exif entry is null. (LP: #1294274)

 -- Ubuntu daily release <ps-jenkins@lists.canonical.com>  Wed, 19 Mar 2014 20:16:40 +0000

thumbnailer (1.0+14.04.20140307-0ubuntu1) trusty; urgency=low

  [ Jussi Pakkanen ]
  * Added visibility info to prevent accidental ABI breakages.
  * Reorient images manually to work around a bug in GdkPixbuf.

 -- Ubuntu daily release <ps-jenkins@lists.canonical.com>  Fri, 07 Mar 2014 15:41:18 +0000

thumbnailer (1.0+14.04.20140304-0ubuntu1) trusty; urgency=low

  [ CI bot ]
  * Resync trunk

  [ Ugo Riboni ]
  * Add a new nonstandard thumbnail size (360) needed by gallery-app To
    test from QML you will need this MR as well:
    https://code.launchpad.net/~amanzi-team/ubuntu-ui-toolkit/ubuntu-ui-
    toolkit-xlarge-thumbnails/+merge/207500 (LP: #1221968)

  [ Jussi Pakkanen ]
  * Error condition checking and error messages.
  * Fix image orientation.

 -- Ubuntu daily release <ps-jenkins@lists.canonical.com>  Tue, 04 Mar 2014 10:09:12 +0000

thumbnailer (1.0+14.04.20140218-0ubuntu1) trusty; urgency=low

  [ Ricardo Salveti de Araujo ]
  * vs-thumb: give pipeline at least 3 seconds to preroll

  [ Jussi Pakkanen ]
  * Created a unique_gobj class for managing gobject based resources.
  * Fix use of #includes. (LP: #1237045)
  * A bunch of fixes to make the project compile on precise.
  * Removed accidentally added file.
  * Invalidate cached images when source has changed.

 -- Ubuntu daily release <ps-jenkins@lists.canonical.com>  Tue, 18 Feb 2014 23:01:31 +0000

thumbnailer (1.0+13.10.20131011-0ubuntu1) saucy; urgency=low

  [ Jussi Pakkanen ]
  * Fix install directory of vs-thumb. (LP: #1235325)
  * Wait for child process to die when killing it with SIGKILL.

  [ Ubuntu daily release ]
  * Automatic snapshot from revision 58

 -- Ubuntu daily release <ps-jenkins@lists.canonical.com>  Fri, 11 Oct 2013 05:41:32 +0000

thumbnailer (1.0+13.10.20131008-0ubuntu1) saucy; urgency=low

  [ Jussi Pakkanen ]
  * Fix off by one error. (LP: #1235444)
  * Disable use of in-process GStreamer because we use 1.0, which
    clashes with 0.10. (LP: #1235484)

  [ Ubuntu daily release ]
  * Automatic snapshot from revision 55

 -- Ubuntu daily release <ps-jenkins@lists.canonical.com>  Tue, 08 Oct 2013 12:49:51 +0000

thumbnailer (1.0+13.10.20131007-0ubuntu1) saucy; urgency=low

  [ Jussi Pakkanen ]
  * Write files into cache atomically.
  * Guard against a frozen worker process.
  * Document the public interface.

  [ Ubuntu daily release ]
  * Automatic snapshot from revision 52

 -- Ubuntu daily release <ps-jenkins@lists.canonical.com>  Mon, 07 Oct 2013 10:52:14 +0000

thumbnailer (1.0+13.10.20131003-0ubuntu1) saucy; urgency=low

  [ Jussi Pakkanen ]
  * Run gstreamer video pipelines in an external process.
  * Get helper path from config.h.
  * Use helper binary from build dir when running tests.
  * Adds support for full resolution thumbnails.

  [ Ubuntu daily release ]
  * Automatic snapshot from revision 48

 -- Ubuntu daily release <ps-jenkins@lists.canonical.com>  Thu, 03 Oct 2013 03:26:49 +0000

thumbnailer (1.0+13.10.20131002-0ubuntu1) saucy; urgency=low

  [ Jussi Pakkanen ]
  * Initial release.
  * Typo fix.

  [ Łukasz 'sil2100' Zemczak ]
  * Automatic snapshot from revision 41 (bootstrap)

  [ Ubuntu daily release ]
  * Automatic snapshot from revision 43

 -- Ubuntu daily release <ps-jenkins@lists.canonical.com>  Wed, 02 Oct 2013 02:34:38 +0000
